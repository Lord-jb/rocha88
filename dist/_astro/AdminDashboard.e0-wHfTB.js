import{q as X,o as Z,c as B,d as L,g as ie,j as e,s as K,b as R,h as ue,u as ee,i as pe,l as ae,k as ge,m as ne,a as le,n as he,f as xe}from"./Providers.xGLPAwM3.js";import{r as c}from"./index.Ba-IbuDT.js";import{c as T,u as ce,o as de}from"./createLucideIcon.BjkHRYOJ.js";import{X as F}from"./x.wBzUDWHC.js";import{T as me}from"./trash-2.D7iKBQ7P.js";import{C as be,a as fe}from"./chevron-right.DsYtaCB9.js";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=T("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=T("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=T("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=T("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=T("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=T("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=T("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=T("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=T("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function se(){return ce({queryKey:["categories"],queryFn:async()=>{const s=X(B(L,"categorias"),Z("nome"));return(await ie(s)).docs.map(o=>({id:o.id,...o.data()}))},staleTime:5*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1})}const Ne="iem94FVEkj3Qjv3DsJXpbQ";async function V(s,t){const o=s.name.split(".").pop()?.toLowerCase()||"jpg";let h="";if(t.type==="main"&&t.productId)h=`${t.productId}.${o}`;else if(t.type==="variation"&&t.productId&&t.variation){const C=t.variation.toLowerCase().replace(/\s+/g,"-");h=`${t.productId}-${C}.${o}`}else h=s.name;const E=new File([s],h,{type:s.type}),N=new FormData;N.append("file",E),N.append("metadata",JSON.stringify({folder:t.folder,productId:t.productId,variation:t.variation,type:t.type,filename:h,uploadDate:new Date().toISOString()}));const k=await fetch("https://imagens.bjeslee19.workers.dev/",{method:"POST",body:N}),j=await k.text();let u;try{u=JSON.parse(j)}catch{u=j}if(!k.ok)throw console.error("Upload error RAW:",u),new Error(typeof u=="string"?u:JSON.stringify(u));if(!u||!u.imageId)throw console.error("Upload OK mas sem imageId:",u),new Error("ID da imagem não retornado pelo servidor");return u.imageId}function G(s,t="public"){return s?s.startsWith("http://")||s.startsWith("https://")||s.startsWith("blob:")||s.startsWith("data:")?s:`https://imagedelivery.net/${Ne}/${s}/${t}`:""}async function W(s){if(s&&!(s.startsWith("http://")||s.startsWith("https://"))&&!(s.startsWith("blob:")||s.startsWith("data:")))try{const t=await fetch("https://imagens.bjeslee19.workers.dev/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageId:s})});if(!t.ok){const o=await t.text();console.error(`Erro ao deletar imagem ${s}:`,o)}}catch(t){console.error(`Erro ao deletar imagem ${s}:`,t)}}async function we(s){const t=s.filter(o=>o&&!o.startsWith("http")&&!o.startsWith("blob:")&&!o.startsWith("data:"));if(t.length!==0)try{const o=await fetch("https://imagens.bjeslee19.workers.dev/delete-multiple",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageIds:t})});if(!o.ok){const h=await o.text();console.error("Erro ao deletar múltiplas imagens:",h)}}catch(o){console.error("Erro ao deletar múltiplas imagens:",o)}}const Ce="1t7T-5mU4ET0kjqd8x_sXlEwunwogCBrlqFnYpVaoyvE",Se="AIzaSyAWUmt2UDeXxY1my2ajGU5bAMSjuU0L14o",ke="produtos!A:Z";function oe(s){return s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().trim()}function Ee(s,t){if(!s||!t)return s;const o=new RegExp(`\\s+${t}$`,"i");return s.replace(o,"").trim()}async function Ie(s){const t=s.trim();if(!t)return null;const o=t.split("_"),h=o.length>2?o.slice(0,o.length-1).join("_"):t,E=`https://sheets.googleapis.com/v4/spreadsheets/${Ce}/values/${encodeURIComponent(ke)}?key=${Se}`,N=await fetch(E);if(!N.ok)throw console.error("Erro ao buscar planilha:",await N.text()),new Error("Não foi possível acessar a planilha do Google Sheets");const j=(await N.json()).values||[];if(!j.length)return null;const[u,...C]=j;console.log("Header da planilha:",u),console.log("Primeira linha de dados:",C[0]);const w=v=>oe(v||""),I=u.findIndex(v=>{const f=w(v);return["ID","CODIGO","CÓDIGO","SKU","COD","CODE"].includes(f)}),g=u.findIndex(v=>{const f=w(v);return["NOME","PRODUTO","DESCRICAO_CURTA","NAME"].includes(f)}),m=u.findIndex(v=>{const f=w(v);return["DESCRICAO","DESCRIÇÃO","DESC","DESCRIPTION"].includes(f)}),P=u.findIndex(v=>{const f=w(v);return["COR","CORES","VARIACAO","VARIACOES","VARIAÇÃO","COLOR"].includes(f)}),A=u.findIndex(v=>{const f=w(v);return["CATEGORIA","CATEGORIAS","GRUPO","CATEGORY"].includes(f)}),D=u.findIndex(v=>{const f=w(v);return["DESTAQUE","HIGHLIGHT","FEATURED"].includes(f)});if(I===-1)throw console.error("Colunas disponíveis:",u.map((v,f)=>`${f}: ${v}`)),new Error(`Coluna de código/SKU não encontrada na planilha. Colunas disponíveis: ${u.join(", ")}`);const l=C.filter(v=>{const f=(v[I]||"").trim();return f?f===h||f.startsWith(h+"_"):!1});if(!l.length)return null;let a="",r="";const n=new Set;let x=!1;const z=[];for(const v of l){const f=g>=0?(v[g]||"").trim():"",$=m>=0?(v[m]||"").trim():"",U=P>=0?(v[P]||"").trim():"",p=A>=0?(v[A]||"").trim():"",y=D>=0?(v[D]||"").trim():"";!a&&f&&(a=U?Ee(f,U):f),!r&&$&&(r=$),p&&p.split(",").map(S=>S.trim()).filter(Boolean).forEach(S=>n.add(S)),typeof y=="string"&&["SIM","TRUE","1","YES","S"].includes(oe(y))&&(x=!0),U&&!z.find(S=>S.cor===U)&&z.push({cor:U})}const q=Array.from(n);return{baseSku:h,nome:a||h,descricao:r,categorias:q,destaque:x,variacoes:z}}function Ae(){const[s,t]=c.useState(""),[o,h]=c.useState(""),[E,N]=c.useState(""),[k,j]=c.useState(!1),[u,C]=c.useState([]),[w,I]=c.useState(null),[g,m]=c.useState(""),[P,A]=c.useState([]),[D,l]=c.useState(""),[a,r]=c.useState(!1),[n,x]=c.useState(""),[z,q]=c.useState(!1),{data:v=[]}=se(),f=i=>{const d=i.target.files?.[0];d&&(I(d),m(URL.createObjectURL(d)))},$=()=>{D.trim()&&(A([...P,{cor:D.trim(),image:null,preview:""}]),l(""))},U=(i,d)=>{const b=[...P];b[i].image=d,b[i].preview=URL.createObjectURL(d),A(b)},p=i=>{A(P.filter((d,b)=>b!==i))},y=async()=>{const i=o.trim();if(i){q(!0),x("");try{const d=await Ie(i);if(!d){x("Nenhum produto encontrado na planilha com esse código.");return}h(d.baseSku),d.nome&&t(d.nome),d.descricao&&N(d.descricao),d.categorias?.length&&C(d.categorias),j(d.destaque),d.variacoes?.length&&A(d.variacoes.map(b=>({cor:b.cor,image:null,preview:""}))),x("Dados preenchidos a partir da planilha ✅")}catch(d){console.error(d),x("Erro ao buscar dados na planilha.")}finally{q(!1)}}},S=async i=>{i.preventDefault(),r(!0),x("");try{if(!w)throw new Error("Selecione a imagem principal");if(!o.trim())throw new Error("Informe um código/SKU");const d=await V(w,{folder:`produtos/${o}`,productId:o,type:"main"}),b=[d],_=[];for(const O of P){if(!O.image)continue;const H=await V(O.image,{folder:`produtos/${o}/variacoes`,productId:o,variation:O.cor,type:"variation"});_.push({cor:O.cor,imagem_url:H,thumb_url:H}),b.push(H)}await K(R(B(L,"produtos"),o),{id:o,nome:s,descricao:E,categorias:u,destaque:k,variacoes:_,imagem_url:d,thumb_url:d,imagens_urls:b,thumbs_urls:b,createdAt:ue()}),x("Produto salvo com sucesso!"),t(""),h(""),N(""),j(!1),C([]),I(null),m(""),A([])}catch(d){console.error(d),x(d instanceof Error?d.message:"Erro ao salvar produto")}finally{r(!1)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Adicionar Produto"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:s,onChange:i=>t(i.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:i=>h(i.target.value),onBlur:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0}),e.jsx("button",{type:"button",onClick:y,disabled:z,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50",children:z?"Buscando...":"Planilha"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:E,onChange:i=>N(i.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(i=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[e.jsx("input",{type:"checkbox",checked:u.includes(i.nome),onChange:d=>{d.target.checked?C(b=>[...b,i.nome]):C(b=>b.filter(_=>_!==i.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:i.nome})]},i.id))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:i=>j(i.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal *"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:g?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:g,alt:"Preview",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>{I(null),m("")},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1",children:e.jsx(F,{size:16})})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(M,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"hidden",required:!0})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:D,onChange:i=>l(i.target.value),onKeyDown:i=>{i.key==="Enter"&&(i.preventDefault(),$())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary"}),e.jsx("button",{type:"button",onClick:$,className:"bg-primary hover:opacity-90 text-text-primary px-4 py-2 rounded-lg font-semibold",children:"Adicionar"})]}),e.jsx("div",{className:"space-y-3",children:P.map((i,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:i.cor}),i.preview?e.jsx("div",{className:"relative w-24 h-24",children:e.jsx("img",{src:i.preview,alt:i.cor,className:"w-full h-full object-cover rounded"})}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(M,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:b=>{const _=b.target.files?.[0];_&&U(d,_)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>p(d),className:"text-red-500 hover:bg-red-50 p-2 rounded",children:e.jsx(F,{size:18})})]},d))})]}),n&&e.jsx("p",{className:`text-center font-semibold ${n.includes("sucesso")||n.includes("planilha")?"text-green-600":"text-red-600"}`,children:n}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-primary hover:opacity-90 text-text-primary font-bold py-3 rounded-lg transition-all disabled:opacity-50",children:a?"Salvando...":"Salvar Produto"})]})]})}function ze({product:s,onClose:t}){const[o,h]=c.useState(s.nome||""),[E,N]=c.useState(s.descricao||""),[k,j]=c.useState(s.destaque||!1),[u,C]=c.useState(s.categorias||[]),[w,I]=c.useState(null),[g,m]=c.useState(s.imagem_url?G(s.imagem_url,"public"):""),[P,A]=c.useState(s.variacoes?.map(p=>({cor:p.cor,image:null,preview:G(p.imagem_url,"public"),existingUrl:p.imagem_url}))||[]),[D,l]=c.useState(""),[a,r]=c.useState(!1),[n,x]=c.useState(""),{data:z=[]}=se(),q=p=>{const y=p.target.files?.[0];y&&(I(y),m(URL.createObjectURL(y)))},v=()=>{D.trim()&&(A([...P,{cor:D.trim(),image:null,preview:""}]),l(""))},f=(p,y)=>{const S=[...P];S[p].image=y,S[p].preview=URL.createObjectURL(y),A(S)},$=p=>{A(P.filter((y,S)=>S!==p))},U=async p=>{p.preventDefault(),r(!0),x("");try{let y=s.imagem_url;w&&(y=await V(w,{folder:`produtos/${s.id}`,productId:s.id,type:"main"}),s.imagem_url&&s.imagem_url!==y&&await W(s.imagem_url));const S=[],i=[y],d=s.variacoes?.map(b=>b.imagem_url)||[];for(const b of P)if(b.image){const _=await V(b.image,{folder:`produtos/${s.id}/variacoes`,productId:s.id,variation:b.cor,type:"variation"});if(S.push({cor:b.cor,imagem_url:_,thumb_url:_}),i.push(_),b.existingUrl&&b.existingUrl!==_){const O=d.indexOf(b.existingUrl);O>-1&&d.splice(O,1)}}else if(b.existingUrl){const _=s.variacoes?.find(O=>O.cor===b.cor);if(_){S.push(_),i.push(_.imagem_url);const O=d.indexOf(_.imagem_url);O>-1&&d.splice(O,1)}}for(const b of d)await W(b);await ee(R(L,"produtos",s.id),{nome:o,descricao:E,categorias:u,destaque:k,variacoes:S,imagem_url:y,thumb_url:y,imagens_urls:i,thumbs_urls:i}),x("Produto atualizado com sucesso!"),setTimeout(()=>t(),1500)}catch(y){console.error(y),x(y instanceof Error?y.message:"Erro ao atualizar produto")}finally{r(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-title font-bold",children:"Editar Produto"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(F,{size:20})})]}),e.jsxs("form",{onSubmit:U,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome"}),e.jsx("input",{type:"text",value:o,onChange:p=>h(p.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"SKU/Código"}),e.jsx("input",{type:"text",value:s.id,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Descrição"}),e.jsx("textarea",{value:E,onChange:p=>N(p.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Categorias"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.map(p=>e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:u.includes(p.nome),onChange:y=>{y.target.checked?C(S=>[...S,p.nome]):C(S=>S.filter(i=>i!==p.nome))},className:"rounded"}),e.jsx("span",{className:"text-sm",children:p.nome})]},p.id))})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:p=>j(p.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Produto em destaque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem Principal"}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4",children:g?e.jsxs("div",{className:"relative aspect-square max-w-xs mx-auto",children:[e.jsx("img",{src:g,alt:"Preview",className:"w-full h-full object-contain"}),e.jsxs("label",{className:"absolute bottom-2 right-2 bg-primary text-white p-2 rounded-full cursor-pointer hover:opacity-90 shadow-lg transition-opacity",children:[e.jsx(M,{size:16}),e.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"hidden"})]})]}):e.jsxs("label",{className:"flex flex-col items-center gap-2 cursor-pointer",children:[e.jsx(M,{className:"text-gray-400",size:48}),e.jsx("span",{className:"text-sm text-gray-600",children:"Clique para selecionar imagem principal"}),e.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"hidden"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Variações de Cor"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:D,onChange:p=>l(p.target.value),onKeyDown:p=>{p.key==="Enter"&&(p.preventDefault(),v())},placeholder:"Nome da cor (ex: Vermelho, Preto fosco)",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none"}),e.jsx("button",{type:"button",onClick:v,className:"bg-primary hover:opacity-90 text-white px-4 py-2 rounded-lg font-semibold transition-opacity",children:"Adicionar"})]}),e.jsx("div",{className:"space-y-3",children:P.map((p,y)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:p.cor}),p.preview?e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("img",{src:p.preview,alt:p.cor,className:"w-full h-full object-cover rounded"}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary text-white p-1 rounded cursor-pointer hover:opacity-90 shadow-md transition-opacity",children:[e.jsx(M,{size:12}),e.jsx("input",{type:"file",accept:"image/*",onChange:S=>{const i=S.target.files?.[0];i&&f(y,i)},className:"hidden"})]})]}):e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx(M,{size:16}),e.jsx("span",{className:"text-xs",children:"Adicionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:S=>{const i=S.target.files?.[0];i&&f(y,i)},className:"hidden"})]})]}),e.jsx("button",{type:"button",onClick:()=>$(y),className:"text-red-500 hover:bg-red-50 p-2 rounded transition-colors",children:e.jsx(F,{size:18})})]},y))})]}),n&&e.jsx("div",{className:`p-3 rounded-lg text-center font-semibold ${n.includes("sucesso")?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:n}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 rounded-lg transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Salvando...":"Salvar Alterações"})]})]})})}function Pe(){const[s,t]=c.useState(0),[o,h]=c.useState([]),[E,N]=c.useState(null),[k,j]=c.useState(null),u=50,C=pe(),w=c.useMemo(()=>{const a=X(B(L,"produtos"),Z("createdAt","desc"),ae(u));return s>0&&o[s-1]?X(B(L,"produtos"),Z("createdAt","desc"),ge(o[s-1]),ae(u)):a},[s,o,u]),{data:I=[],isLoading:g,refetch:m,isFetching:P}=ce({queryKey:["admin-products",s,u,o[s-1]?.id],queryFn:async()=>{const r=(await ie(w)).docs;return r.length>0&&h(n=>{const x=[...n];return x[s]=r[r.length-1],x}),r.map(n=>({id:n.id,...n.data()}))},placeholderData:a=>a??[],staleTime:3e4}),A=async a=>{if(confirm(`Tem certeza que deseja excluir "${a.nome}"?`)){j(a.id);try{const r=[];a.imagem_url&&r.push(a.imagem_url),a.thumb_url&&a.thumb_url!==a.imagem_url&&r.push(a.thumb_url),a.imagens_urls?.length&&a.imagens_urls.forEach(n=>{r.includes(n)||r.push(n)}),a.thumbs_urls?.length&&a.thumbs_urls.forEach(n=>{r.includes(n)||r.push(n)}),a.variacoes?.length&&a.variacoes.forEach(n=>{n.imagem_url&&!r.includes(n.imagem_url)&&r.push(n.imagem_url),n.thumb_url&&!r.includes(n.thumb_url)&&r.push(n.thumb_url)}),await we(r),await ne(R(L,"produtos",a.id)),await C.invalidateQueries({queryKey:["admin-products"]}),await m()}catch(r){console.error("Erro ao deletar produto:",r),alert("Erro ao deletar produto")}finally{j(null)}}},D=a=>{N(a)},l=()=>{N(null),C.invalidateQueries({queryKey:["admin-products"]}),m()};return g&&!I.length?e.jsx("div",{className:"text-center py-8",children:"Carregando produtos..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-xl font-title font-bold",children:["Produtos Cadastrados ",P&&e.jsx("span",{className:"text-sm text-gray-400",children:"(atualizando…)"})]})}),e.jsx("div",{className:"max-h-[600px] overflow-auto divide-y",children:I.map(a=>{const r=a.thumb_url||a.imagem_url||a.imagens_urls?.[0],n=r?de(r,"public"):"";return e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 hover:bg-gray-50",children:[n?e.jsx("img",{src:n,alt:a.nome??"Produto",className:"w-16 h-16 object-contain rounded bg-gray-50"}):e.jsx("div",{className:"w-16 h-16 flex items-center justify-center bg-gray-100 rounded",children:e.jsx("span",{className:"text-xs text-gray-400",children:"Sem img"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:a.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",a.id]}),e.jsx("div",{className:"flex gap-2 mt-1 flex-wrap",children:a.categorias?.map(x=>e.jsx("span",{className:"text-xs bg-gray-200 px-2 py-1 rounded",children:x},x))}),a.variacoes&&a.variacoes.length>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.variacoes.length," variações de cor"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>D(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Editar",disabled:k===a.id,children:e.jsx(je,{size:18})}),e.jsx("button",{onClick:()=>A(a),className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Excluir",disabled:k===a.id,children:k===a.id?e.jsx("div",{className:"w-[18px] h-[18px] border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsx(me,{size:18})})]})]},a.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>t(a=>Math.max(0,a-1)),disabled:s===0,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:[e.jsx(be,{size:18}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",s+1]}),e.jsxs("button",{onClick:()=>t(a=>a+1),disabled:I.length<u,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg disabled:opacity-50 hover:bg-gray-200",children:["Próximo",e.jsx(fe,{size:18})]})]})]}),E&&e.jsx(ze,{product:E,onClose:l})]})}function De(){const[s,t]=c.useState(""),[o,h]=c.useState(!1),[E,N]=c.useState(null),[k,j]=c.useState(""),[u,C]=c.useState(!1),{data:w=[],refetch:I}=se(),g=l=>{const a=l.target.files?.[0];a&&(N(a),j(URL.createObjectURL(a)))},m=async l=>{l.preventDefault(),C(!0);try{const a=s.toLowerCase().replace(/\s+/g,"-");let r="";E&&(r=await V(E,{folder:"categorias",productId:a,type:"category"})),await K(R(L,"categorias",a),{id:a,nome:s,productCount:0,popular:o,imagePath:r}),t(""),h(!1),N(null),j(""),I()}catch(a){console.error(a),alert("Erro ao criar categoria")}finally{C(!1)}},P=async l=>{if(confirm("Tem certeza? Esta ação não pode ser desfeita."))try{l.imagePath&&await W(l.imagePath),await ne(R(L,"categorias",l.id)),I()}catch(a){console.error(a),alert("Erro ao excluir categoria")}},A=async l=>{try{await ee(R(L,"categorias",l.id),{popular:!l.popular}),I()}catch(a){console.error(a),alert("Não foi possível atualizar popular")}},D=async(l,a)=>{try{const r=await V(a,{folder:"categorias",productId:l.id,type:"category"});l.imagePath&&await W(l.imagePath),await ee(R(L,"categorias",l.id),{imagePath:r}),I()}catch(r){console.error(r),alert("Não foi possível atualizar a imagem")}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-title font-bold mb-6",children:"Gerenciar Categorias"}),e.jsxs("form",{onSubmit:m,className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da categoria"}),e.jsx("input",{type:"text",value:s,onChange:l=>t(l.target.value),placeholder:"Nome da categoria",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Imagem da categoria"}),k?e.jsxs("div",{className:"relative w-full h-24",children:[e.jsx("img",{src:k,alt:"Preview",className:"w-full h-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{N(null),j("")},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1",children:e.jsx(F,{size:14})})]}):e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(M,{size:16}),e.jsx("span",{className:"text-sm",children:"Selecionar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:l=>h(l.target.checked),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm font-semibold",children:"Marcar como categoria popular"})]}),e.jsx("button",{type:"submit",disabled:u,className:"w-full bg-primary hover:opacity-90 text-text-primary font-semibold px-6 py-3 rounded-lg disabled:opacity-50",children:u?"Criando...":"Criar Categoria"})]}),e.jsx("div",{className:"space-y-2",children:w.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[l.imagePath&&e.jsx("img",{src:de(l.imagePath,"public"),alt:l.nome,className:"w-16 h-16 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:l.nome}),e.jsxs("p",{className:"text-sm text-gray-500",children:[l.productCount||0," produtos"]}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-3",children:[e.jsx("button",{onClick:()=>void A(l),className:`px-3 py-1 rounded border text-sm ${l.popular?"bg-green-600 text-white border-green-600":"bg-white text-gray-700 border-gray-300"}`,children:l.popular?"Popular ✓":"Marcar como popular"}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-1 bg-white border border-gray-300 rounded cursor-pointer hover:bg-gray-50",children:[e.jsx(M,{size:14}),e.jsx("span",{className:"text-xs",children:"Alterar imagem"}),e.jsx("input",{type:"file",accept:"image/*",onChange:a=>{const r=a.target.files?.[0];r&&D(l,r)},className:"hidden"})]})]})]})]}),e.jsx("button",{onClick:()=>void P(l),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(me,{size:18})})]},l.id))})]})}function _e(){const[s,t]=c.useState({banners:[],promotions:[],popups:[]}),[o,h]=c.useState(!1),[E,N]=c.useState(null),[k,j]=c.useState("");c.useEffect(()=>{u()},[]);const u=async()=>{try{const a=await le(R(L,"config","layout"));a.exists()&&t(a.data())}catch(a){console.error("Erro ao carregar assets:",a),j("Erro ao carregar configurações")}},C=async a=>{await K(R(L,"config","layout"),a)},w=(a,r=3e3)=>{j(a),setTimeout(()=>j(""),r)},I=async a=>{h(!0),N("logo");try{const r=await V(a,{folder:"layout",type:"logo"});s.logo&&await W(s.logo);const n={...s,logo:r};await C(n),t(n),w("Logo atualizado com sucesso!")}catch(r){console.error(r),w("Erro ao fazer upload do logo")}finally{h(!1),N(null)}},g=async(a,r,n,x)=>{h(!0),N(r);try{const z=[];for(let f=0;f<a.length;f++){const $=await V(a[f],{folder:n,type:x});z.push($)}const q={...s,[r]:[...s[r],...z]};await C(q),t(q),w(`${{banners:"Banners",promotions:"Promoções",popups:"Popups"}[r]} adicionados com sucesso!`)}catch(z){console.error(z),w("Erro ao fazer upload")}finally{h(!1),N(null)}},m=async(a,r)=>{try{const n=s[a][r];await W(n);const x={...s,[a]:s[a].filter((z,q)=>q!==r)};await C(x),t(x),w("Item removido com sucesso!")}catch(n){console.error(n),w("Erro ao remover item")}},P=async()=>{if(s.logo)try{await W(s.logo);const a={...s,logo:void 0};await C(a),t(a),w("Logo removido com sucesso!")}catch(a){console.error(a),w("Erro ao remover logo")}},A=(a,r,n=!1,x=!1,z)=>e.jsxs("label",{className:`group relative inline-flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-primary/10 to-primary/5 border-2 border-dashed border-primary/30 rounded-xl cursor-pointer hover:border-primary hover:from-primary/20 hover:to-primary/10 transition-all ${x?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-white rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:x?e.jsx(ye,{size:20,className:"animate-spin text-primary"}):z||e.jsx(M,{size:20,className:"text-primary"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:a}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Clique para selecionar ",n?"arquivos":"arquivo"]})]}),e.jsx("input",{type:"file",accept:"image/*",multiple:n,onChange:q=>{q.target.files&&r(q.target.files)},className:"hidden",disabled:o})]}),D=(a,r,n)=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:a.map((x,z)=>e.jsxs("div",{className:`relative ${n} border-2 border-gray-200 rounded-xl overflow-hidden group hover:border-primary transition-colors bg-gray-50`,children:[e.jsx("img",{src:G(x,"public"),alt:`${r} ${z+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center",children:e.jsx("button",{onClick:()=>void m(r,z),className:"opacity-0 group-hover:opacity-100 bg-red-500 hover:bg-red-600 text-white rounded-full p-3 transition-all shadow-lg transform scale-75 group-hover:scale-100",title:"Remover",children:e.jsx(F,{size:20})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("p",{className:"text-white text-xs font-medium text-center",children:[r==="banners"?"Banner":r==="promotions"?"Promoção":"Popup"," #",z+1]})})]},`${x}-${z}`))}),l=(a,r)=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:a}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:r})]});return e.jsxs("div",{className:"space-y-8",children:[k&&e.jsx("div",{className:`p-4 rounded-xl text-center font-semibold shadow-md animate-fade-in ${k.includes("sucesso")?"bg-green-50 text-green-700 border-2 border-green-200":"bg-red-50 text-red-700 border-2 border-red-200"}`,children:k}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(re,{size:20,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Logo Principal"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logotipo exibido no cabeçalho do site"})]})]}),s.logo?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-64 h-32 border-2 border-gray-200 rounded-xl p-4 group hover:border-primary transition-colors bg-gray-50",children:e.jsx("img",{src:G(s.logo,"public"),alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("button",{onClick:()=>void P(),className:"absolute -top-3 -right-3 bg-red-500 hover:bg-red-600 text-white rounded-full p-2 shadow-lg transition-all transform hover:scale-110",title:"Remover logo",children:e.jsx(F,{size:18})})]}):A("Adicionar Logo",a=>void I(a[0]),!1,E==="logo",e.jsx(re,{size:20,className:"text-primary"}))]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/10 rounded-lg flex items-center justify-center",children:e.jsx(J,{size:20,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Banners Hero"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Slides principais da página inicial (formato landscape)"})]})]}),e.jsx("div",{className:"mb-6",children:A("Adicionar Banners",a=>void g(a,"banners","layout/banners","banner"),!0,E==="banners",e.jsx(J,{size:20,className:"text-primary"}))}),s.banners.length>0?D(s.banners,"banners","aspect-video"):l(e.jsx(J,{size:28,className:"text-gray-400"}),"Nenhum banner adicionado. Adicione imagens em formato landscape (16:9)")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Y,{size:20,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Promoções em Destaque"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cards de ofertas e promoções especiais (formato quadrado)"})]})]}),e.jsx("div",{className:"mb-6",children:A("Adicionar Promoções",a=>void g(a,"promotions","layout/promocoes","promotion"),!0,E==="promotions",e.jsx(Y,{size:20,className:"text-primary"}))}),s.promotions.length>0?D(s.promotions,"promotions","aspect-square"):l(e.jsx(Y,{size:28,className:"text-gray-400"}),"Nenhuma promoção adicionada. Use imagens quadradas (1:1) para melhor visualização")]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/10 rounded-lg flex items-center justify-center",children:e.jsx(Q,{size:20,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-title font-bold text-gray-800",children:"Popups"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Modais promocionais exibidos aos visitantes (formato quadrado)"})]})]}),e.jsx("div",{className:"mb-6",children:A("Adicionar Popups",a=>void g(a,"popups","layout/popups","popup"),!0,E==="popups",e.jsx(Q,{size:20,className:"text-primary"}))}),s.popups.length>0?D(s.popups,"popups","aspect-square"):l(e.jsx(Q,{size:28,className:"text-gray-400"}),"Nenhum popup adicionado. Popups aparecem automaticamente para os visitantes")]})]})}function qe(){const[s,t]=c.useState({whatsappNumber:"",companyName:"",companyEmail:"",companyAddress:""}),[o,h]=c.useState(!1),[E,N]=c.useState(!0),[k,j]=c.useState("");c.useEffect(()=>{u()},[]);const u=async()=>{N(!0);try{const g=await le(R(L,"config","general"));if(g.exists()){const m=g.data();t({whatsappNumber:m.whatsappNumber||"",companyName:m.companyName||"",companyEmail:m.companyEmail||"",companyAddress:m.companyAddress||""})}}catch(g){console.error("Erro ao carregar configurações:",g),j("Erro ao carregar configurações")}finally{N(!1)}},C=g=>{const m=g.replace(/\D/g,"");return m.length<=2?m:m.length<=7?`(${m.slice(0,2)}) ${m.slice(2)}`:m.length<=11?`(${m.slice(0,2)}) ${m.slice(2,7)}-${m.slice(7)}`:`(${m.slice(0,2)}) ${m.slice(2,7)}-${m.slice(7,11)}`},w=g=>{const m=C(g.target.value);t({...s,whatsappNumber:m})},I=async g=>{g.preventDefault(),h(!0),j("");try{const m=s.whatsappNumber.replace(/\D/g,"");if(m.length<10){j("Número de WhatsApp inválido"),h(!1);return}await K(R(L,"config","general"),{whatsappNumber:m,companyName:s.companyName,companyEmail:s.companyEmail||"",companyAddress:s.companyAddress||"",updatedAt:new Date().toISOString()}),j("Configurações salvas com sucesso!"),setTimeout(()=>j(""),3e3)}catch(m){console.error("Erro ao salvar configurações:",m),j("Erro ao salvar configurações")}finally{h(!1)}};return E?e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(te,{className:"text-primary",size:24}),e.jsx("h2",{className:"text-xl font-title font-bold",children:"Configurações Gerais"})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Importante:"})," O número de WhatsApp configurado aqui será usado para receber todos os pedidos do catálogo."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Número do WhatsApp *"}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:s.whatsappNumber,onChange:w,placeholder:"(00) 00000-0000",className:"w-full pl-11 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Digite apenas números. Ex: 5589994333316"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Nome da Empresa *"}),e.jsx("input",{type:"text",value:s.companyName,onChange:g=>t({...s,companyName:g.target.value}),placeholder:"Rocha Brindes",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"E-mail da Empresa"}),e.jsx("input",{type:"email",value:s.companyEmail,onChange:g=>t({...s,companyEmail:g.target.value}),placeholder:"contato@rochabrindes.com.br",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Endereço da Empresa"}),e.jsx("textarea",{value:s.companyAddress,onChange:g=>t({...s,companyAddress:g.target.value}),placeholder:"Rua Exemplo, 123 - Bairro - Cidade - Estado",rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),k&&e.jsx("div",{className:`p-4 rounded-lg text-center font-semibold ${k.includes("sucesso")?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:k}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-primary hover:opacity-90 text-white font-bold py-3 px-6 rounded-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-3 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{size:20}),"Salvar Configurações"]})})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2",children:"Prévia do número configurado:"}),e.jsx("p",{className:"text-lg font-mono text-primary",children:s.whatsappNumber||"(Nenhum número configurado)"}),s.whatsappNumber&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Link: https://wa.me/",s.whatsappNumber.replace(/\D/g,"")]})]})]})}function Te(){const[s,t]=c.useState("products"),o=async()=>{await he(xe)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-title font-bold",children:"Painel Admin"}),e.jsx("button",{onClick:o,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg",children:"Sair"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex gap-4 mb-6 overflow-x-auto",children:[e.jsx("button",{onClick:()=>t("products"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="products"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Produtos"}),e.jsx("button",{onClick:()=>t("categories"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="categories"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Categorias"}),e.jsx("button",{onClick:()=>t("layout"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="layout"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Layout"}),e.jsx("button",{onClick:()=>t("config"),className:`px-6 py-2 rounded-lg font-semibold transition-all whitespace-nowrap ${s==="config"?"bg-primary text-text-primary":"bg-white text-gray-600 hover:bg-gray-100"}`,children:"Configurações"})]}),s==="products"&&e.jsxs("div",{className:"space-y-8",children:[e.jsx(Ae,{}),e.jsx(Pe,{})]}),s==="categories"&&e.jsx(De,{}),s==="layout"&&e.jsx(_e,{}),s==="config"&&e.jsx(qe,{})]})]})}export{Te as default};
